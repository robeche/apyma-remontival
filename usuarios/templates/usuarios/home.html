{% extends 'usuarios/base.html' %}
{% load i18n %}
{% load static %}

{% block title %}{% trans "Apyma Remontival - CP Remontival IP" %}{% endblock %}

{% block content %}

<!-- Hero Section with Carousel -->
<div class="hero-section fade-in-up">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Carousel -->
            <div id="heroCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="2000">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="4" aria-label="Slide 5"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="5" aria-label="Slide 6"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="6" aria-label="Slide 7"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="7" aria-label="Slide 8"></button>
                    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="8" aria-label="Slide 9"></button>
                </div>
                <div class="carousel-inner">
                    <!-- Slide 1: Imagen -->
                    

                    <div class="carousel-item active">
                        <img src="{% static 'usuarios/images_carrousel/SomosApyma1_noback.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>

                    <div class="carousel-item">
                        <img src="{% static 'usuarios/images_carrousel/SomosApyma2_noback.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>

                    <div class="carousel-item">
                        <img src="{% static 'usuarios/images_carrousel/SomosApyma3_noback.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>

                    <div class="carousel-item">
                        <img src="{% static 'usuarios/images_carrousel/SomosApyma4_noback.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>

                    <div class="carousel-item">
                        <img src="{% static 'usuarios/images_carrousel/SomosApyma5_noback.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>

                    <div class="carousel-item">
                        <img src="{% static 'usuarios/images_carrousel/SomosApyma6_noback.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>

                    <div class="carousel-item">
                        <img src="{% static 'usuarios/images_carrousel/SomosApyma7_noback.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>

                    <div class="carousel-item">
                        <img src="{% static 'usuarios/images_carrousel/SomosApyma8_noback.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>

                    <div class="carousel-item">
                        <img src="{% static 'usuarios/images_carrousel/APYMA.png' %}" class="d-block w-100 rounded shadow carousel-responsive-img" alt="{% trans 'Apyma Remontival' %}" style="object-fit: contain; background-color: #f8f9fa;">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">{% trans "Anterior" %}</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">{% trans "Siguiente" %}</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Servicios -->
<div class="row g-4">
    <!-- Columna de Noticias -->
    <div class="col-lg-6">
        <div class="card card-modern fade-in-up h-100">
            <div class="card-header card-header-modern">
                <h2><i class="bi bi-newspaper"></i> {% trans "Últimas Noticias" %}</h2>
            </div>
            <div class="card-body card-body-modern">
                {% if noticias_recientes %}
                    {% for noticia in noticias_recientes %}
                        <div class="news-item mb-3 {% if not forloop.last %}border-bottom pb-3{% endif %}">
                            <div class="d-flex">
                                {% if noticia.imagen %}
                                    <div class="flex-shrink-0 me-3">
                                        <img src="{{ noticia.imagen.url }}" 
                                             alt="{{ noticia.titulo }}" 
                                             class="rounded news-thumbnail"
                                             style="width: 80px; height: 60px; object-fit: cover;">
                                    </div>
                                {% endif %}
                                <div class="flex-grow-1">
                                    <h5 class="news-title mb-1">
                                        <a href="{% url 'noticia_detalle' noticia.id %}" class="text-decoration-none">
                                            {% get_current_language as LANGUAGE_CODE %}
                                            {% if LANGUAGE_CODE == 'eu' and noticia.titulo_eu %}
                                                {{ noticia.titulo_eu }}
                                            {% else %}
                                                {{ noticia.titulo }}
                                            {% endif %}
                                        </a>
                                    </h5>
                                    <p class="text-muted small mb-1">
                                        <i class="bi bi-calendar3"></i> {{ noticia.fecha_publicacion|date:"d/m/Y" }}
                                    </p>
                                    <p class="news-summary mb-0">
                                        {% if LANGUAGE_CODE == 'eu' and noticia.resumen_eu %}
                                            {{ noticia.resumen_eu|truncatewords:15 }}
                                        {% else %}
                                            {{ noticia.resumen|truncatewords:15 }}
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                    <div class="text-center mt-3">
                        <a href="{% url 'noticias' %}" class="btn btn-primary-modern btn-modern">
                            <i class="bi bi-arrow-right"></i> {% trans "Ver todas las noticias" %}
                        </a>
                    </div>
                {% else %}
                    <div class="text-center text-muted py-4">
                        <i class="bi bi-newspaper" style="font-size: 3rem; opacity: 0.3;"></i>
                        <p class="mt-2">{% trans "No hay noticias disponibles" %}</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Columna de Actividades -->
    <div class="col-lg-6">
        <div class="card card-modern fade-in-up h-100">
            <div class="card-header card-header-modern">
                <h2><i class="bi bi-calendar-event"></i> {% trans "Próximas Actividades" %}</h2>
            </div>
            <div class="card-body card-body-modern">
                {% if actividades_proximas %}
                    {% for actividad in actividades_proximas %}
                        <div class="activity-item mb-3 {% if not forloop.last %}border-bottom pb-3{% endif %}">
                            <div class="d-flex">
                                {% if actividad.imagen %}
                                    <div class="flex-shrink-0 me-3">
                                        <img src="{{ actividad.imagen.url }}" 
                                             alt="{{ actividad.titulo }}" 
                                             class="rounded activity-thumbnail"
                                             style="width: 80px; height: 60px; object-fit: cover;">
                                    </div>
                                {% endif %}
                                <div class="flex-grow-1">
                                    <h5 class="activity-title mb-1">
                                        <a href="{% url 'actividad_detalle' actividad.id %}" class="text-decoration-none">
                                            {{ actividad.titulo|default:actividad.get_tipo_actividad_display }}
                                        </a>
                                    </h5>
                                    <p class="text-muted small mb-1">
                                        <i class="bi bi-calendar3"></i> {{ actividad.fecha|date:"d/m/Y" }}
                                        <i class="bi bi-clock ms-2"></i> {{ actividad.hora_comienzo|time:"H:i" }}
                                        {% if actividad.donde %}
                                            <i class="bi bi-geo-alt ms-2"></i> {{ actividad.donde }}
                                        {% endif %}
                                    </p>
                                    <p class="activity-description mb-0">
                                        {{ actividad.descripcion|truncatewords:15 }}
                                    </p>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                    <div class="text-center mt-3">
                        <a href="{% url 'actividades' %}" class="btn btn-success-modern btn-modern">
                            <i class="bi bi-arrow-right"></i> {% trans "Ver todas las actividades" %}
                        </a>
                    </div>
                {% else %}
                    <div class="text-center text-muted py-4">
                        <i class="bi bi-calendar-event" style="font-size: 3rem; opacity: 0.3;"></i>
                        <p class="mt-2">{% trans "No hay actividades programadas" %}</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- CSS responsivo para el carrusel -->
<style>
/* Carrusel responsivo - altura ajustada para móviles */
.carousel-responsive-img {
    height: 625px; /* Altura por defecto para escritorio */
}

@media (max-width: 768px) {
    .carousel-responsive-img {
        height: 250px !important;
    }
}

@media (min-width: 769px) and (max-width: 992px) {
    .carousel-responsive-img {
        height: 400px !important;
    }
}

/* Estilos para noticias y actividades */
.news-item, .activity-item {
    transition: all 0.3s ease;
}

.news-item:hover, .activity-item:hover {
    background-color: rgba(0, 123, 255, 0.02);
    border-radius: 8px;
    padding: 8px;
    margin: -8px;
}

.news-title a, .activity-title a {
    color: #333;
    font-size: 0.95rem;
    font-weight: 600;
    line-height: 1.3;
}

.news-title a:hover, .activity-title a:hover {
    color: #007bff;
}

.news-summary, .activity-description {
    font-size: 0.875rem;
    color: #666;
    line-height: 1.4;
}

.news-thumbnail, .activity-thumbnail {
    border: 1px solid #e9ecef;
}

/* Responsive para móviles */
@media (max-width: 768px) {
    .news-thumbnail, .activity-thumbnail {
        width: 60px !important;
        height: 45px !important;
    }
    
    .news-title, .activity-title {
        font-size: 0.9rem;
    }
    
    .news-summary, .activity-description {
        font-size: 0.8rem;
    }
}
</style>

{% endblock %}
